script.js:
// static/script.js - FULLY INTEGRATED WITH SIDEBAR LOGIC (Source/Middle/Destination labels)

// --- Configuration (Must match Python config) ---
const NUM_PEGS = 3;
// UPDATED: Peg names to Source, Middle, Destination
const PEG_NAMES = ['Source', 'Middle', 'Destination']; 
const CANVAS_WIDTH = 650;
const CANVAS_HEIGHT = 450;
const DISK_HEIGHT = 20;
const PEG_X_POS = [120, 325, 530];
const PEG_Y_BASE = CANVAS_HEIGHT - 40;

let moves = [];
let moveIndex = 0;
let disksOnPegs = [[], [], []]; 
let diskColors = ["#4D70B3", "#8A9A5B", "#FF6F61", "#B565A7", "#48AAAD", "#F7CAC9", "#9B772A", "#6B5B95"];

// --- DOM Elements ---
const canvas = document.getElementById('hanoi-canvas');
const diskInput = document.getElementById('disk-input');
const speedInput = document.getElementById('speed-input');
const speedValue = document.getElementById('speed-value');
const statusMessage = document.getElementById('status-message');
const nextBtn = document.getElementById('next-btn');
const autoBtn = document.getElementById('auto-btn');
const solveBtn = document.getElementById('solve-btn');

// Sidebar DOM Elements
const explanationContent = document.getElementById('explanation-content');
const currentMoveNum = document.getElementById('current-move-num');
const totalMovesNum = document.getElementById('total-moves-num');

let autoRunTimer = null; 

// --- Initialization and Drawing ---

function getDiskColor(diskId) {
    return diskColors[(diskId - 1) % diskColors.length];
}

function getDiskWidth(diskId) {
    return 50 + diskId * 18;
}

function drawInitialState() {
    canvas.innerHTML = ''; // Clear canvas
    disksOnPegs = [[], [], []];

    // Draw Base
    canvas.innerHTML += `<rect x="50" y="${PEG_Y_BASE}" width="${CANVAS_WIDTH - 100}" height="10" fill="#8D6E63"/>`;
    
    // Draw Pegs and Labels
    PEG_X_POS.forEach((x, i) => {
        canvas.innerHTML += `<rect x="${x - 5}" y="${PEG_Y_BASE - 250}" width="10" height="250" fill="#3E2723"/>`;
        // UPDATED: Use PEG_NAMES for labels here
        canvas.innerHTML += `<text x="${x}" y="${PEG_Y_BASE + 20}" font-weight="bold" font-size="12" fill="#3E2723" text-anchor="middle">${PEG_NAMES[i].toUpperCase()}</text>`;
    });

    try {
        const nDisks = parseInt(diskInput.value);
        if (isNaN(nDisks) || nDisks < 3 || nDisks > 8) throw new Error("Invalid disk count");

        // Create disks (largest first)
        for (let i = nDisks; i >= 1; i--) {
            const diskWidth = getDiskWidth(i);
            const pegIndex = 0;
            
            const yBottom = PEG_Y_BASE - (disksOnPegs[pegIndex].length * DISK_HEIGHT);
            const yTop = yBottom - DISK_HEIGHT;
            const xCenter = PEG_X_POS[pegIndex];
            
            // Draw the disk as a rectangle in the SVG
            canvas.innerHTML += `<rect id="disk-${i}" 
                                      x="${xCenter - diskWidth / 2}" 
                                      y="${yTop}" 
                                      width="${diskWidth}" 
                                      height="${DISK_HEIGHT}" 
                                      fill="${getDiskColor(i)}" 
                                      stroke="white" 
                                      stroke-width="1"/>`;
            
            disksOnPegs[pegIndex].push(i);
        }
        statusMessage.textContent = `Ready for N=${nDisks} Disks`;
        statusMessage.style.color = '#007bff';

    } catch (e) {
        statusMessage.textContent = e.message;
        statusMessage.style.color = 'red';
    }
}

// --- Event Handlers (No changes needed) ---

speedInput.addEventListener('input', () => {
    speedValue.textContent = `${speedInput.value}ms`;
});

async function generateAndStart() {
    if (autoRunTimer) toggleAutoRun(); 
    
    if (solveBtn.textContent === "Reset") {
        drawInitialState();
        solveBtn.textContent = "Generate & Start";
        nextBtn.disabled = true;
        autoBtn.disabled = true;
        
        // Reset Sidebar content and counter
        explanationContent.innerHTML = '<p>Click "Generate & Start" to begin the solution.</p><p>Instructions for each disk move will appear here.</p>';
        currentMoveNum.textContent = '0';
        totalMovesNum.textContent = '0';
        return;
    }

    try {
        const nDisks = parseInt(diskInput.value);
        if (isNaN(nDisks) || nDisks < 3 || nDisks > 8) throw new Error("Disks must be between 3 and 8");

        drawInitialState();
        moves = [];
        moveIndex = 0;
        
        explanationContent.innerHTML = ''; 

        const response = await fetch('/solve', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ disks: nDisks })
        });
        
        if (!response.ok) throw new Error('Failed to fetch moves from backend.');
        
        const data = await response.json();
        moves = data.moves;
        
        totalMovesNum.textContent = moves.length; 
        currentMoveNum.textContent = '0'; 

        statusMessage.textContent = `Total Moves: ${moves.length}`;
        statusMessage.style.color = '#333';
        
        nextBtn.disabled = false;
        autoBtn.disabled = false;
        solveBtn.textContent = "Reset";

    } catch (error) {
        statusMessage.textContent = `Error: ${error.message}`;
        statusMessage.style.color = 'red';
    }
}

function toggleAutoRun() {
    if (autoRunTimer) {
        clearInterval(autoRunTimer);
        autoRunTimer = null;
        autoBtn.textContent = "Auto Run";
        nextBtn.disabled = false;
    } else {
        autoBtn.textContent = "Stop";
        nextBtn.disabled = true;
        autoRunTimer = setInterval(nextMove, parseInt(speedInput.value));
    }
}

// --- Animation Core ---

function nextMove() {
    if (moveIndex >= moves.length) {
        clearInterval(autoRunTimer);
        autoRunTimer = null;
        // UPDATED: Final message uses Destination
        statusMessage.textContent = "ðŸŽ‰ Puzzle Solved! All disks successfully moved to Destination.";
        statusMessage.style.color = 'green';
        nextBtn.disabled = true;
        autoBtn.disabled = true;
        autoBtn.textContent = "Auto Run";
        
        // Final message in the sidebar
        explanationContent.innerHTML += `<div class="step-item active"><strong>COMPLETE!</strong> All ${diskInput.value} disks are now on Destination.</div>`;
        return;
    }

    const [diskId, sourceIdx, destIdx] = moves[moveIndex];
    moveIndex++;

    // 1. Update Logic Array
    if (disksOnPegs[sourceIdx]) {
        disksOnPegs[sourceIdx].pop();
        disksOnPegs[destIdx].push(diskId);
    }

    // 2. Calculate Final Position
    const newYBottom = PEG_Y_BASE - (disksOnPegs[destIdx].length * DISK_HEIGHT);
    const finalYTop = newYBottom - DISK_HEIGHT;
    const finalXCenter = PEG_X_POS[destIdx];
    
    // --- Sidebar Explanation Generation ---
    const sourceName = PEG_NAMES[sourceIdx];
    const destName = PEG_NAMES[destIdx];
    const explanation = generateExplanation(diskId, sourceName, destName, diskInput.value);

    const stepDiv = document.createElement('div');
    stepDiv.className = 'step-item active';
    stepDiv.id = `step-${moveIndex}`;
    stepDiv.innerHTML = `<strong>Step ${moveIndex}:</strong> ${explanation}`;

    const previousActive = document.querySelector('.step-item.active');
    if (previousActive) {
        previousActive.classList.remove('active');
    }
    
    explanationContent.appendChild(stepDiv);
    stepDiv.scrollIntoView({ behavior: 'smooth', block: 'end' }); 

    // Update Status Bar 
    // UPDATED: Status message uses PEG_NAMES
    statusMessage.textContent = `Move ${moveIndex}/${moves.length}: Moving Disk ${diskId} from ${sourceName} to ${destName}`;
    statusMessage.style.color = '#6A5ACD';
    currentMoveNum.textContent = moveIndex; 

    // 3. Animate the Disk
    animateDisk(diskId, finalXCenter, finalYTop);
}

function animateDisk(diskId, targetXCenter, targetYTop) {
    const diskElement = document.getElementById(`disk-${diskId}`);
    
    const diskWidth = getDiskWidth(diskId);
    const targetX = targetXCenter - diskWidth / 2;
    
    diskElement.setAttribute('x', targetX);
    diskElement.setAttribute('y', targetYTop);
}

// --- Helper Function for Explanations ---

function generateExplanation(diskId, sourceName, destName, totalDisks) {
    // MODIFIED: Replacing **Markdown** with <strong>HTML</strong> tags

    let explanation = `Relocate <strong>Disk ${diskId}</strong> from <strong>${sourceName}</strong> to <strong>${destName}</strong>.`;
    
    if (diskId == totalDisks) {
        explanation += ` This is the <strong>Largest Disk</strong> (Base Disk). It moves only when the entire stack above it is cleared.`;
    } else if (diskId == 1) {
        explanation += ` This is the <strong>Smallest Disk</strong> (Disk 1). It is used frequently to temporarily stage the larger stack.`;
    }
    
    if (destName === 'Destination') {
        explanation += ` This move advances the disk to the <strong>FINAL DESTINATION</strong> pole.`;
    } else if (destName === 'Middle') {
        explanation += ` This move uses the <strong>MIDDLE</strong> pole to facilitate a larger move later.`;
    } else if (destName === 'Source') {
        explanation += ` This move stages the disk back onto the <strong>SOURCE</strong> pole temporarily.`;
    }
    
    return explanation;
}


// --- Initial Setup ---
window.onload = drawInitialState;

style.css:
/* static/style.css - DARK THEME with SIDEBAR */

/* --- Global & Container (Your Existing Code) --- */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #1e1e1e; 
    color: #cccccc; 
    display: flex;
    justify-content: center;
    padding: 20px;
    margin: 0;
}

.container {
    background-color: #252526; 
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4); 
    width: 980px; /* INCREASED width to accommodate the sidebar */
    text-align: center;
}

h1 {
    color: #4CAF50; 
    margin-bottom: 20px;
    font-size: 1.8em;
}

/* --- Controls (Your Existing Code) --- */
.controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
    padding: 10px;
    border: 1px solid #3c3c3c; 
    border-radius: 8px;
    background-color: #2d2d30;
}

label {
    font-weight: 600;
    color: #a0a0a0;
}

input[type="number"], input[type="range"] {
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #444; 
    background-color: #333333;
    color: #cccccc;
}

/* --- Buttons (Your Existing Code) --- */
button {
    padding: 10px 18px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s;
    font-weight: 600;
    color: white;
}

#solve-btn {
    background-color: #569cd6; 
}
#solve-btn:hover {
    background-color: #4780b9;
}

#auto-btn {
    background-color: #4CAF50; 
}
#auto-btn:hover {
    background-color: #3f9043;
}

#next-btn {
    background-color: #ffc107; 
    color: #333;
}
#next-btn:hover {
    background-color: #e0a800;
}

button:disabled {
    background-color: #444;
    color: #888;
    cursor: not-allowed;
}

/* --- Status Bar (Your Existing Code) --- */
.status-bar {
    text-align: left;
    margin-bottom: 10px;
    padding: 8px;
    border-bottom: 2px solid #3c3c3c;
}

#status-message {
    font-size: 1.1em;
    font-weight: bold;
    color: #569cd6;
}

/* --- SVG/Canvas (Your Existing Code) --- */
#hanoi-canvas {
    background-color: #1f1f1f; 
    border: 2px solid #3c3c3c;
    border-radius: 8px;
}

/* --- NEW Layout and Sidebar Styles --- */

.main-content {
    display: flex; /* Enables side-by-side layout */
    justify-content: space-between;
    margin-top: 20px;
    gap: 20px; /* Space between canvas and sidebar */
}

/* --- Sidebar Styling --- */
.sidebar {
    width: 300px; /* Fixed width for the sidebar */
    background-color: #2d2d30; /* Slightly lighter than container */
    padding: 15px;
    border-radius: 8px;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3); /* Inner shadow for depth */
    text-align: left;
    height: 450px; /* Match the canvas height */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.sidebar h2 {
    color: #4CAF50; 
    border-bottom: 2px solid #3c3c3c;
    padding-bottom: 8px;
    margin-bottom: 10px;
    font-size: 1.3em;
}

#explanation-content {
    flex-grow: 1; 
    font-size: 1em;
    line-height: 1.5;
    color: #cccccc;
    overflow-y: auto; 
}

.move-counter {
    background-color: #333333;
    padding: 10px;
    border-radius: 6px;
    text-align: center;
    margin-top: 15px;
}

.move-counter p {
    margin: 0;
    font-weight: bold;
    color: #cccccc;
}

.move-counter span {
    color: #569cd6; 
}

/* Styling for the dynamically added steps */
.step-item {
    padding: 10px;
    border-left: 3px solid #569cd6;
    margin-bottom: 10px;
    background-color: #333333;
    border-radius: 4px;
    transition: background-color 0.3s;
}

.step-item.active {
    background-color: #3a3a3a; 
    border-left: 3px solid #4CAF50; 
    box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
}

index.html:
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classic Tower of Hanoi Solver</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Tower of Hanoi Solver</h1>

        <div class="controls">
            <label for="disk-input">Disks (3-8):</label>
            <input type="number" id="disk-input" value="4" min="3" max="8">
            
            <label for="speed-input">Speed (ms):</label>
            <input type="range" id="speed-input" value="500" min="100" max="1500" step="100">
            <span id="speed-value">500ms</span>

            <button id="solve-btn" onclick="generateAndStart()">Generate & Start</button>
            <button id="next-btn" onclick="nextMove()" disabled>Next Step</button>
            <button id="auto-btn" onclick="toggleAutoRun()" disabled>Auto Run</button>
        </div>
        
        <div class="status-bar">
            <span id="status-message">Ready</span>
        </div>

        <div class="main-content">
            
            <svg id="hanoi-canvas" width="650" height="450"></svg>

            <div class="sidebar">
                <h2>Solution Guidance</h2>
                <div id="explanation-content">
                    <p>Click "Generate & Start" to begin the solution.</p>
                    <p>Instructions for each disk move will appear here.</p>
                </div>
                <div class="move-counter">
                    <p>Move: <span id="current-move-num">0</span> / <span id="total-moves-num">0</span></p>
                </div>
            </div>
        </div>
        
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>

app.py:
# app.py
from flask import Flask, render_template, request, jsonify

app = Flask(__name__)

# --- Core Solver Logic (Copied from your previous Python code) ---
class TowerOfHanoiSolver:
    def __init__(self):
        self.moves = []

    def solve(self, n):
        self.moves = []
        self._tower_of_hanoi(n, 0, 1, 2) # Use indices 0, 1, 2 for pegs A, B, C
        return self.moves

    def _tower_of_hanoi(self, n, source, auxiliary, destination):
        """Recursive function to calculate the moves (disk_id, source_peg, dest_peg)"""
        if n == 1:
            self.moves.append((1, source, destination))
            return

        self._tower_of_hanoi(n - 1, source, destination, auxiliary)
        self.moves.append((n, source, destination))
        self._tower_of_hanoi(n - 1, auxiliary, source, destination)

# --- Flask Routes ---

@app.route('/')
def index():
    """Serves the main HTML page."""
    return render_template('index.html')

@app.route('/solve', methods=['POST'])
def solve_puzzle():
    """Handles the AJAX request from the frontend to calculate the moves."""
    try:
        data = request.get_json()
        n_disks = int(data.get('disks', 3))
        
        if not (3 <= n_disks <= 8):
            return jsonify({'error': 'Disks must be between 3 and 8'}), 400

        solver = TowerOfHanoiSolver()
        # The Python logic returns (disk_id, source_peg_index, dest_peg_index)
        moves = solver.solve(n_disks) 
        
        return jsonify({'moves': moves})
        
    except Exception as e:
        return jsonify({'error': str(e)}), 500

if __name__ == '__main__':
    # Running in debug mode for development
    app.run(debug=True)